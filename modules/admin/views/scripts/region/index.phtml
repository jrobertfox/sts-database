<?php
	$sortableArray = array();
	$n = 1;
	foreach ($this->regions as $name => $region) {
			$sortableArray[] = '#sortable'. $n;
			$n++;
		}
	$sortableList = '"'.implode(", ", $sortableArray).'"';
?>

<script>
    $(function() {
        $( <?php echo $sortableList ?> ).sortable().disableSelection();
 
        var $tabs = $( "#tabs" ).tabs();
 
        var $tab_items = $( "ul:first li", $tabs ).droppable({
            accept: ".connectedSortable li",
            hoverClass: "ui-state-hover",
            drop: function( event, ui ) {
                var $item = $( this );
                var $list = $( $item.find( "a" ).attr( "href" ) )
                    .find( ".connectedSortable" );
 
                ui.draggable.hide( "slow", function() {
                    $tabs.tabs( "select", $tab_items.index( $item ) );
                    $( this ).appendTo( $list ).show( "slow" );
                    $( this ).addClass("btn-success");
                });
            }
        });
    });
</script>

<div id="tabs">
	<ul>
	<?php 
	$n = 1;
	foreach ($this->regions as $name => $region) {
		echo "<li><a href=\"#tabs-$n\">$name</a></li>";
		$n++;
	}
	?>
	</ul>
		<?php 
		$n = 1;
		foreach ($this->regions as $name => $region) {
			echo "<div id=\"tabs-$n\">";
			echo "<ul id=\"sortable$n\" class=\"connectedSortable ui-helper-reset\">";
			foreach ($region['areas'] as $area) {
				echo "<li class=\"btn btn-large\"><i class=\"icon-move\"></i> ".$area->getCity()."</li>";
			}
			echo "</ul></div>";
			$n++;
		}
		?>
</div>
